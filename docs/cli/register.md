# syncagent register

Register this machine with a SyncAgent server.

## Usage

```bash
syncagent register --server <url> --token <token> [--name <name>]
```

## Options

| Option | Required | Description |
|--------|----------|-------------|
| `--server` | Yes | Server URL (e.g., http://localhost:8000) |
| `--token` | Yes | Invitation token from server admin |
| `--name` | No | Machine name (default: hostname) |

## Description

Creates a connection between this machine and a SyncAgent server.
Requires an invitation token generated by the server administrator.

## Behavior

### Prerequisites

- Must have run `syncagent init` first
- Need a valid invitation token from server admin

### Machine Name

- Default: system hostname
- Sanitized to alphanumeric, hyphens, and underscores only
- Must be unique on the server

### Files Modified

- `~/.syncagent/config.json` - Adds server_url, auth_token, machine_name

### Success Output

```
Machine registered successfully!
Server: <server-url>
Machine name: <machine-name>
```

### Error Cases

| Condition | Message | Exit Code |
|-----------|---------|-----------|
| Not initialized | "Error: SyncAgent not initialized. Run 'syncagent init' first." | 1 |
| Invalid token | "Error: Invalid or expired invitation token." | 1 |
| Duplicate name | "Error: Machine name '<name>' already exists on server." | 1 |
| Server unreachable | "Error: Could not connect to server at <url>" | 1 |

### Re-registration

If already registered, shows warning and asks for confirmation:
```
Warning: This machine is already registered.
Do you want to re-register with a new server? [y/N]
```

## Server API

Calls `POST /api/machines/register` with:
```json
{
  "name": "<machine-name>",
  "platform": "<os>",
  "invitation_token": "<token>"
}
```
